<Window x:Class="KeyStats.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewmodels="clr-namespace:KeyStats.ViewModels"
        Title="按键统计 - 设置"
        Width="400" Height="400"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ShowInTaskbar="True">

    <Window.DataContext>
        <viewmodels:SettingsViewModel/>
    </Window.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- App Icon and Title -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
            <TextBlock Text="⌨️" FontSize="32" VerticalAlignment="Center" Margin="0,0,12,0"/>
            <StackPanel VerticalAlignment="Center">
                <TextBlock Text="按键统计" FontSize="18" FontWeight="Bold"/>
                <TextBlock Text="设置" Style="{StaticResource SecondaryText}"/>
            </StackPanel>
        </StackPanel>

        <!-- Settings -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Display Options -->
                <TextBlock Text="托盘显示" Style="{StaticResource SectionTitle}" Margin="0,0,0,8"/>
                <CheckBox Content="显示按键次数" IsChecked="{Binding ShowKeyPresses}" Margin="0,4"/>
                <CheckBox Content="显示点击次数" IsChecked="{Binding ShowMouseClicks}" Margin="0,4"/>

                <!-- Startup -->
                <TextBlock Text="启动" Style="{StaticResource SectionTitle}"/>
                <CheckBox Content="Windows 启动时自动运行" IsChecked="{Binding LaunchAtStartup}" Margin="0,4"/>

                <!-- Dynamic Icon Color -->
                <TextBlock Text="动态图标" Style="{StaticResource SectionTitle}"/>
                <CheckBox Content="根据输入速度动态改变图标颜色"
                          IsChecked="{Binding EnableDynamicIconColor}" Margin="0,4"/>

                <StackPanel Orientation="Horizontal" Margin="20,8,0,0"
                            Visibility="{Binding ShowDynamicIconColorStyleOptions, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBlock Text="颜色样式：" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <ComboBox SelectedIndex="{Binding DynamicIconColorStyleIndex}" Width="100">
                        <ComboBoxItem Content="图标"/>
                        <ComboBoxItem Content="圆点"/>
                    </ComboBox>
                </StackPanel>

                <!-- Notifications -->
                <TextBlock Text="通知" Style="{StaticResource SectionTitle}"/>
                <CheckBox Content="启用里程碑通知"
                          IsChecked="{Binding NotificationsEnabled}" Margin="0,4"/>

                <StackPanel Visibility="{Binding ShowThresholdOptions, Converter={StaticResource BoolToVisibilityConverter}}"
                            Margin="20,8,0,0">
                    <!-- Key Press Threshold -->
                    <StackPanel Orientation="Horizontal" Margin="0,4">
                        <TextBlock Text="按键阈值：" VerticalAlignment="Center" Width="130"/>
                        <TextBox Text="{Binding KeyPressThreshold, UpdateSourceTrigger=PropertyChanged}"
                                 Width="80" TextAlignment="Right" Margin="0,0,4,0"/>
                        <Button Content="−" Width="24" Padding="0" Command="{Binding DecrementKeyThresholdCommand}"/>
                        <Button Content="+" Width="24" Padding="0" Margin="2,0,0,0" Command="{Binding IncrementKeyThresholdCommand}"/>
                    </StackPanel>

                    <!-- Click Threshold -->
                    <StackPanel Orientation="Horizontal" Margin="0,4">
                        <TextBlock Text="点击阈值：" VerticalAlignment="Center" Width="130"/>
                        <TextBox Text="{Binding ClickThreshold, UpdateSourceTrigger=PropertyChanged}"
                                 Width="80" TextAlignment="Right" Margin="0,0,4,0"/>
                        <Button Content="−" Width="24" Padding="0" Command="{Binding DecrementClickThresholdCommand}"/>
                        <Button Content="+" Width="24" Padding="0" Margin="2,0,0,0" Command="{Binding IncrementClickThresholdCommand}"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Reset Button -->
        <Button Grid.Row="2" Content="重置今日统计"
                Command="{Binding ResetStatsCommand}"
                HorizontalAlignment="Left" Margin="0,20,0,0"/>
    </Grid>
</Window>
